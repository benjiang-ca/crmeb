(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fa99d034"],{cdfe:function(t,a,e){t.exports=e.p+"mer/img/f.5aa43cd3.png"},ceef:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"divBox"},[i("el-card",{staticClass:"box-card"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("el-form",{attrs:{inline:""}},[i("el-form-item",[i("el-select",{attrs:{placeholder:"状态",clearable:""},on:{change:t.getList},model:{value:t.tableFrom.status,callback:function(a){t.$set(t.tableFrom,"status",a)},expression:"tableFrom.status"}},t._l(t.optionsData,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),i("el-form-item",[i("el-input",{staticClass:"selWidth",attrs:{placeholder:"请输入关键字"},model:{value:t.tableFrom.keyword,callback:function(a){t.$set(t.tableFrom,"keyword",a)},expression:"tableFrom.keyword"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getList},slot:"append"})],1)],1)],1),t._v(" "),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.onAdd}},[t._v("添加客服")])],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData.data,size:"small"}},[i("el-table-column",{attrs:{prop:"service_id",label:"ID","min-width":"60"}}),t._v(" "),i("el-table-column",{attrs:{prop:"user.nickname",label:"微信用户名称","min-width":"130"}}),t._v(" "),i("el-table-column",{attrs:{label:"客服头像","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(t){return[i("div",{staticClass:"demo-image__preview"},[i("el-image",{staticClass:"tabImage",attrs:{src:t.row.avatar,"preview-src-list":[t.row.avatar]}})],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"nickname",label:"客服名称","min-width":"130"}}),t._v(" "),i("el-table-column",{attrs:{label:"是否显示","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[i("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":"显示","inactive-text":"隐藏"},nativeOn:{click:function(e){return t.onchangeIsShow(a.row)}},model:{value:a.row.status,callback:function(e){t.$set(a.row,"status",e)},expression:"scope.row.status"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"create_time",label:"添加时间","min-width":"150"}}),t._v(" "),i("el-table-column",{attrs:{label:"操作","min-width":"150",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.goList(a.row.service_id,a.$index)}}},[t._v("聊天记录")]),t._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.onEdit(a.row.service_id)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.onDel(a.row.service_id,a.$index)}}},[t._v("删除")])]}}])})],1),t._v(" "),i("div",{staticClass:"block"},[i("el-pagination",{attrs:{"page-sizes":[20,40,60,80],"page-size":t.tableFrom.limit,"current-page":t.tableFrom.page,layout:"total, sizes, prev, pager, next, jumper",total:t.tableData.total},on:{"size-change":t.handleSizeChange,"current-change":t.pageChange}})],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"聊天记录",width:t.isChat?"500px":"800px",visible:t.dialogTableVisible},on:{"update:visible":function(a){t.dialogTableVisible=a}}},[t.isChat?i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingChat,expression:"loadingChat"}],key:"isIndex",attrs:{data:t.tableChatData.data}},[i("el-table-column",{attrs:{property:"user.nickname",label:"用户名称","min-width":"100"}}),t._v(" "),i("el-table-column",{attrs:{label:"用户头像","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(t){return[t.row.user.avatar?i("img",{staticClass:"tabImage",attrs:{src:t.row.user.avatar}}):i("img",{staticClass:"tabImage",attrs:{src:e("cdfe")}})]}}],null,!1,3196233401)}),t._v(" "),i("el-table-column",{attrs:{label:"操作",fixed:"right","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.check(a.row.uid,a.$index)}}},[t._v("查看对话")])]}}],null,!1,252509333)})],1):t._e(),t._v(" "),t.isChat?t._e():i("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.goBack}},[t._v("返回聊天记录")]),t._v(" "),t.isChat?t._e():i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingChat,expression:"loadingChat"}],key:"isIndexs",attrs:{data:t.tableServiceData.data}},[i("el-table-column",{attrs:{label:"发送人","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[i("span",[t._v(t._s(0===a.row.send_type?a.row.user.nickname:a.row.service.nickname))])]}}],null,!1,1916843481)}),t._v(" "),i("el-table-column",{attrs:{label:"发送人头像","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(t){return[t.row.user.avatar?i("img",{staticClass:"tabImage",attrs:{src:t.row.user.avatar}}):i("img",{staticClass:"tabImage",attrs:{src:e("cdfe")}})]}}],null,!1,3196233401)}),t._v(" "),i("el-table-column",{attrs:{prop:"msn",label:"发送消息","min-width":"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"create_time",label:"发送时间","min-width":"100"}})],1),t._v(" "),i("div",{staticClass:"block"},[i("el-pagination",{attrs:{"page-sizes":[20,40,60,80],"page-size":t.tableFrom.limit,"current-page":t.tableFrom.page,layout:"total, sizes, prev, pager, next, jumper",total:t.isChat?t.tableChatData.total:t.tableServiceData.total},on:{"size-change":t.handleSizeChangeChat,"current-change":t.pageChangeChat}})],1)],1)],1)},s=[],l=e("8593"),n=[{value:"1",label:"显示"},{value:"0",label:"隐藏"}],o={name:"Service",data:function(){return{isChat:!1,loadingChat:!1,dialogTableVisible:!1,optionsData:n,loading:!1,tableData:{data:[],total:0},tableFrom:{page:1,limit:20,keyword:"",status:""},tableChatFrom:{page:1,limit:8},tableChatData:{data:[],total:0},tableServiceData:{data:[],total:0},serviceId:0,uid:""}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;this.loading=!0,Object(l["r"])(this.tableFrom).then((function(a){t.tableData.data=a.data.list,t.tableData.total=a.data.count,t.loading=!1})).catch((function(a){t.$message.error(a.message),t.loading=!1}))},pageChange:function(t){this.tableFrom.page=t,this.getList()},handleSizeChange:function(t){this.tableFrom.limit=t,this.getList()},goList:function(t){this.serviceId=t,this.dialogTableVisible=!0,this.tableChatFrom.page=1,this.getListChat(),this.isChat=!0},goBack:function(){this.tableChatFrom.page=1,this.getListChat(),this.isChat=!0},check:function(t){this.uid=t,this.serviceChatUidList(t),this.isChat=!1},getListChat:function(){var t=this;this.loadingChat=!0,Object(l["n"])(this.serviceId,this.tableChatFrom).then((function(a){t.tableChatData.data=a.data.list,t.tableChatData.total=a.data.count,t.loadingChat=!1})).catch((function(a){t.$message.error(a.message),t.loadingChat=!1}))},serviceChatUidList:function(t){var a=this;this.loadingChat=!0,Object(l["o"])(this.serviceId,t,this.tableChatFrom).then((function(t){a.tableChatData.data=[],a.tableServiceData.data=t.data.list,a.tableServiceData.total=t.data.count,a.loadingChat=!1})).catch((function(t){a.$message.error(t.message),a.loadingChat=!1}))},pageChangeChat:function(t){this.tableChatFrom.page=t,this.isChat?this.getListChat():this.serviceChatUidList(this.uid)},handleSizeChangeChat:function(t){this.tableChatFrom.limit=t,this.getListChat(),this.isChat?this.getListChat():this.serviceChatUidList(this.uid)},onAdd:function(){var t=this;this.$modalForm(Object(l["p"])()).then((function(){return t.getList()}))},onEdit:function(t){var a=this;this.$modalForm(Object(l["t"])(t)).then((function(){return a.getList()}))},onDel:function(t,a){var e=this;this.$modalSure().then((function(){Object(l["q"])(t).then((function(t){var i=t.message;e.$message.success(i),e.tableData.data.splice(a,1)})).catch((function(t){var a=t.message;e.$message.error(a)}))}))},onchangeIsShow:function(t){var a=this;Object(l["s"])(t.service_id,t.status).then((function(t){var e=t.message;a.$message.success(e),a.getList()})).catch((function(t){var e=t.message;a.$message.error(e)}))}}},r=o,c=e("2877"),u=Object(c["a"])(r,i,s,!1,null,"61504ae6",null);a["default"]=u.exports}}]);